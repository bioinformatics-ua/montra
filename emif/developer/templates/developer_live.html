{% comment %}
# -*- coding: utf-8 -*-
# Copyright (C) 2014 Universidade de Aveiro, DETI/IEETA, Bioinformatics Group - http://bioinformatics.ua.pt/
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}
{% load url from future %}
{% load extra_tags %}

{% block styleinclude %}
<link href='{{ STATIC_URL }}css/opensans.css' rel='stylesheet' type='text/css'>
        <link href='{{ STATIC_URL }}css/abel.css' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="{{ STATIC_URL }}css/bootstrap.min.css">

        <link rel="stylesheet" href="{{ STATIC_URL }}css/vendor/jquery-ui-1.10.4.custom.min.css">
        <link rel="stylesheet" href="{{ STATIC_URL }}css/main.css" />
        <link rel="stylesheet" href="{{ STATIC_URL }}font-awesome/css/font-awesome.min.css">
        <link href="{{ STATIC_URL }}font-awesome-4.2.0/css/font-awesome.min.css" rel="stylesheet">


    <link rel="stylesheet" href="{{ STATIC_URL}}css/vendor/jquery.gridster.css" />

    <link rel="stylesheet" href="{{ STATIC_URL}}css/emif.dashboard.css" />
{% endblock %}

{% block headextra %}
        <script src="{{ STATIC_URL }}js/vendor/inheritance.js"></script>
        <script src="{{ STATIC_URL }}js/vendor/jquery-1.9.1.min.js"></script>
        <script src="{{ STATIC_URL }}js/vendor/jquery-ui-1.10.4.custom.min.js"></script>
        <script src="{{ STATIC_URL }}js/vendor/bootbox.min.js"></script>

    <script src="{{ STATIC_URL}}js/vendor/jquery.gridster.min.js"></script>

    <script src="{{ STATIC_URL}}js/vendor/jquery.dashboard.js"></script>

    <script src="{{ STATIC_URL}}js/vendor/widgets/widget.plug_shell.js"></script>
    <script src="{{ STATIC_URL}}js/emif.livepreview.js"></script>
{% endblock %}

{% block content %}
    {% if plugin.type == 0 %}
        <div id="playground_test" style="margin-left: 0px;">
            {% if not version.is_remote %}
            <script type="text/javascript">
                console.log('LIVE PREVIEW FOR LOCAL FILE, GLOBAL WIDGETS');
                sandbox('{{plugin.slug}}',
                    function(callback){
                        var confs, plugin;

                        {{version.path|safe}}

                        if(callback) callback(confs, plugin);

                    });
            </script>
            {% else %}
                <script type="text/javascript">
                    console.log('LIVE PREVIEW FOR REMOTE FILE, GLOBAL WIDGETS')
                    $.get('{{version.path|safe}}')
                        .done(function(data){
                            console.log(data);
                            sandbox('{{plugin.slug}}', data);
                        })
                        .fail(function(data){
                            codeError("We couldn't obtain the remote plugin from url: '{{version.path|safe}}'");
                        });
                </script>
            {%endif%}
        </div>
    {% endif %}
    {% if plugin.type == 1 %}
        Fingerprint plugins previews are not available yet.
    {% endif %}
    {% if plugin.type == 2 %}
            <script type="text/javascript">
                window.location.replace('{{version.path|safe}}');
            </script>
    {% endif %}
{% endblock %}
